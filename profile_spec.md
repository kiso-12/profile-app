# プロフィール アプリ仕様書
---

## 1. `index.html` の仕様書：アプリの「骨格」

`index.html`ファイルは、アプリの見た目や内容を構成する「**骨格**」です。わたしたちの体で例えるなら、骨や筋肉のようなもので、どこに何があるか、どんな形をしているかを決めます。ユーザーが見て、触れるすべての要素（ボタン、入力欄、画像など）は、このHTMLファイルに記述されています。

### 主な役割

* **コンテンツの配置**: アプリのタイトル、プロフィール入力欄、プロフィールプレビューなど、すべての情報をどこに表示するかを決めます。
* **入力要素の提供**: ユーザーが情報を入力するための**テキストボックス**（氏名、自己紹介）や、ファイルをアップロードするための**ボタン**（プロフィール画像）を提供します。
* **ボタンの設置**: 情報を「**保存**」したり、「**リセット**」したりするためのボタンを配置します。
* **外部ファイルとの連携**: デザインを担当するCSSファイル（`style.css`）や、アプリの動きを制御するJavaScriptファイル（`script.js`）を読み込む指示をします。

### 具体的な要素と意図

* **`<div class="container">`**: アプリ全体のコンテンツを包み込む大きな箱です。これにより、デザインを適用しやすくなり、アプリ全体が中央にまとまって見えます。
* **`<div class="input-section card">`**: プロフィール情報を入力する部分です。ユーザーが氏名や自己紹介を入力したり、画像を選択したりするエリアです。「`card`」という目印（クラス）をつけることで、後でCSSでカード型のおしゃれなデザインを適用できます。
* **`<input type="file" id="imageUpload" accept="image/*">`**: プロフィール画像をパソコンから選ぶためのボタンです。`accept="image/*"`と指定することで、画像ファイルだけを選べるようになります。
* **`<button id="resetImageBtn" class="secondary-btn">`**: プロフィール画像を初期状態に戻すためのボタンです。「`secondary-btn`」という目印で、保存ボタンとは違う見た目にできます。
* **`<div class="preview-section card">`**: 入力したプロフィールがどのように見えるかを確認する「プレビュー」部分です。
* **`<img id="profileImagePreview">`**: プレビューとして表示されるプロフィール画像です。ユーザーが画像を選んだり、デフォルトの状態に戻したりすると、この画像の表示が変わります。
* **`<h3 id="profileNamePreview">` / `<p id="profileIntroductionPreview">`**: プレビューとして表示される氏名と自己紹介文です。
* **`<script src="script.js"></script>`**: これが最も重要で、`script.js`というJavaScriptファイルを読み込む指示です。この行がないと、アプリはまったく動きません。

---

## 2. `style.css` の仕様書：アプリの「見た目」

`style.css`ファイルは、アプリの「**見た目**」を担当します。HTMLで定義された骨格に、色、形、配置、アニメーションといった「服装」を着せるようなものです。ユーザーが「おしゃれ」「使いやすい」と感じるかどうかは、このCSSのデザインにかかっています。

### 主な役割

* **色の設定**: 背景の色、文字の色、ボタンの色などを決めます。
* **レイアウトの調整**: 各要素をどこに配置するか（例：中央寄せ、横並び）、要素間の隙間（余白）などを調整します。
* **要素の装飾**: ボタンや入力欄の角を丸くしたり、影をつけたり、フォントの種類や大きさを設定したりします。
* **インタラクションの追加**: マウスカーソルがボタンに乗ったとき（**ホバー**）や、ボタンをクリックしたとき（**アクティブ**）に、色が変わったり、少し動いたりするアニメーション効果を設定します。これにより、アプリが「生きている」ように感じられます。
* **レスポンシブデザイン**: 画面のサイズ（スマートフォン、タブレット、PCなど）に合わせて、表示を自動的に調整し、どのデバイスでも見やすくします。

### 具体的なスタイルと意図

* **`body` の背景**: 単色ではなく、美しい**グラデーション背景**（`linear-gradient`）を適用しました。これにより、アプリ全体に統一感と洗練された印象を与えます。フォントもモダンな「Roboto」を使用しています。
* **`.container` のデザイン**: アプリ全体を囲む白い箱に、大きな影と丸みのある角を与え、立体感と柔らかさを表現しています。
* **`.card` クラスの導入**: 入力セクションとプレビューセクションに共通のカードスタイルを適用します。薄いグレーの背景と控えめな影で、各セクションが「カード」のように独立して見えます。
* **`input`, `textarea`, `button` のデザイン**:
    * `padding`（内側の余白）を増やして、ゆったりとした見た目に。
    * `border-radius`（角丸）を大きくして、親しみやすい印象に。
    * `transition`プロパティを使って、マウスが乗ったり、クリックしたりしたときの色の変化や動きを**滑らか**にしています。特にボタンは、ホバーで少し浮き上がり、クリックで沈むような効果で、ユーザーに操作が成功したことを視覚的に伝えます。
* **`.image-upload-controls`**: 画像選択ボタンとリセットボタンを`display: flex;`で**横並び**に配置し、`gap`で適切な間隔を空けています。
* **`.secondary-btn`**: リセットボタンに適用されるスタイルです。メインの保存ボタン（緑色）とは異なるグレーの色とサイズにすることで、ユーザーに「これは補助的な機能だな」と直感的に伝わります。
* **`@media (max-width: 768px)`**: スマートフォンなどの画面幅が狭いデバイスで、要素が**縦に並ぶ**ようにレイアウトを調整しています。これにより、スクロールせずにすべての要素が見えるようになります。

---

## 3. `script.js` の仕様書：アプリの「頭脳」と「動き」

`script.js`ファイルは、アプリの「**頭脳**」であり、「**動き**」を制御する司令塔です。ユーザーがボタンをクリックしたり、文字を入力したりといった「行動」に対して、アプリがどのように「反応」するかを指示します。

### 主な役割

* **HTML要素の操作 (DOM操作)**: HTMLファイルで定義された各要素（入力欄、画像、ボタンなど）をJavaScriptから見つけ出して、その内容（テキスト、画像URLなど）を読み取ったり、書き換えたりします。
* **イベント処理**: 「ボタンがクリックされたら」「文字が入力されたら」「ページが読み込まれたら」といった、ユーザーの行動やアプリの状態変化（**イベント**）を監視し、それに応じて特定の処理を実行します。
* **データの保存と読み込み**: ユーザーが入力したプロフィール情報をブラウザの**ローカルストレージ**に保存し、次回アプリを開いたときに自動で読み込んで表示します。これにより、入力した情報が消えないようになります。
* **非同期処理**: 画像ファイルの読み込みのように、時間がかかる処理をアプリの動作を止めずに（裏で）行うための仕組み（**Promise**、**async/await**）を使います。

### 具体的な機能と意図

* **`document.getElementById('ID')`**: HTMLファイル内の特定の`id`を持つ要素（例：`profileImagePreview`というIDを持つ画像）をJavaScriptで「指し示す」ための命令です。これにより、JavaScriptがそれらの要素の情報を読み取ったり、表示を変えたりできるようになります。
* **`loadProfile()` 関数**: アプリが起動したときや、プロフィールが保存された後に実行されます。
    * **ローカルストレージ**から保存されたプロフィール情報を読み込み、各入力欄とプレビュー表示に反映させます。
    * `JSON.parse()`: 保存された文字列データをJavaScriptで扱える形（オブジェクト）に変換します。
* **`saveProfile()` 関数**: 「プロフィールを保存」ボタンがクリックされたときに実行されます。
    * 各入力欄の現在の値と、現在プレビューに表示されている画像データ（**Base64形式**）をまとめて一つのオブジェクトにします。
    * 新しい画像ファイルが選択されていれば、`readFileAsBase64()`を使ってその画像をBase64形式に変換し、保存データに含めます。
    * `JSON.stringify()`: JavaScriptのオブジェクトを、ローカルストレージに保存できる文字列形式に変換します。
    * `localStorage.setItem('myProfile', profileJSON);`: 変換した文字列をローカルストレージに保存します。
    * **エラーハンドリング**: ローカルストレージには容量制限（通常5MB程度）があるため、画像が大きすぎると保存できない場合があります。その際にエラーを検知し、ユーザーに分かりやすいメッセージを表示します。
* **`readFileAsBase64(file)` 関数**: ユーザーが選択した画像ファイル（`File`オブジェクト）を、ウェブページで表示したりローカルストレージに保存したりできる特殊な形式（**Base64データURL**）に変換する専門の関数です。`FileReader`というJavaScriptの機能を使います。
* **`updatePreview()` 関数**: 画像選択欄、氏名入力欄、自己紹介入力欄のいずれかの内容が変更されるたびに実行されます。
    * 選択された画像ファイルをリアルタイムで読み込み、プレビュー画像として表示します。
    * 入力中の氏名や自己紹介文も、その場でプレビューに反映させます。これにより、ユーザーは入力しながら完成イメージを確認できます。
* **`resetImage()` 関数**: 「画像をリセット」ボタンがクリックされたときに実行されます。
    * ファイル選択欄の内容をクリアし、プレビュー画像をデフォルトのプレースホルダー画像に戻します。
    * **注意点**: この操作だけではローカルストレージのデータは変わりません。リセットした状態を保存するには、別途「プロフィールを保存」ボタンを押す必要があります。
* **イベントリスナーの設定 (`addEventListener`)**:
    * ページが読み込まれたら、保存済みのプロフィールを自動で表示します。
    * 保存ボタンがクリックされたら、データを保存します。
    * 入力欄や画像選択欄の内容が変更されたら、プレビューをリアルタイムで更新します。
    * リセットボタンがクリックされたら、画像をリセットします。

---

## 4. アプリの機能フロー (Mermaid記法)

ここでは、アプリの主要な機能がどのように連携しているかを、Mermaid記法で図示します。

```mermaid
graph TD
    A[アプリ起動/再読み込み] --> B{保存データあり?};
    B -- はい --> C[ローカルストレージからデータ読み込み];
    B -- いいえ --> D[プレビューを初期状態に設定];
    C --> E[入力欄とプレビューを更新];

    subgraph ユーザーアクション
        F[ユーザーが入力欄を変更] --> G[プレビューをリアルタイム更新];
        H[ユーザーが画像ファイルを変更] --> I[選択画像をプレビュー表示];
        I --> G;
        J[ユーザーが画像をリセットボタンクリック] --> K[ファイル選択欄をクリア];
        K --> G;
        L[ユーザーがプロフィール保存ボタンクリック] --> M[現在の入力値とプレビュー画像を取得];
        M --> N{画像ファイルが選択された?};
        N -- はい --> O[画像ファイルをBase64に変換];
        O --> P[変換データを保存オブジェクトに設定];
        N -- いいえ & 画像がリセット済み --> Q[画像データをnullに設定];
        N -- いいえ & 画像がBase64/外部URL --> R[現在のプレビュー画像を保存オブジェクトに設定];
        P --> S[プロフィールデータをJSONに変換];
        Q --> S;
        R --> S;
        S --> T{ローカルストレージに保存};
        T -- 成功 --> U[保存成功メッセージ表示];
        T -- 失敗 例: 容量オーバー --> V[エラーメッセージ表示];
        U --> E;
    end

    E --> Z[アプリ表示];
    G --> Z;
